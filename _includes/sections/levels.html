{%- comment -%}
Levels section â€” one section per level

section.data expects:
  - label:            string            e.g., "Levels"
  - intention_label:  string            e.g., "Intention"
  - edge_label:       string            e.g., "Edge"
  - flows_label:      string            e.g., "Flows"
  - items:            array of level objects

Each level item shape:
  - color:     string    # level color (used by icons/level.svg)
  - label:     string    # level label, e.g., "7th Kyu"
  - level:     number    # keeps your schema for reference
  - intention: string
  - edge:      string
  - flows:     array of {label, url}
{%- endcomment -%}

{%- assign D = section.data -%}
{%- if D.items and D.items.size > 0 -%}

  {%- comment -%} Global header {%- endcomment -%}
  <section class="md-flow levels-header" aria-labelledby="levels-title">
    {%- if D.label -%}
      <h2 id="levels-title">{{ D.label }}</h2>
    {%- endif -%}
  </section>

  {%- for lv in D.items -%}
  <section class="md-flow level" id="{{ lv.label | slugify }}" aria-labelledby="{{ lv.label | slugify }}-title">
    <h3 class="level-title" id="{{ lv.label | slugify }}-title">
      {% include icons/level.svg
         class="md-level-svg"
         color=lv.color
         title=lv.label %}
      <span>{{ lv.label }}</span>
    </h3>

    {%- if D.intention_label and lv.intention -%}
      <p><strong>{{ D.intention_label }}</strong></p>
      <p>{{ lv.intention }}</p>
    {%- endif -%}

    {%- if D.edge_label and lv.edge -%}
      <p><strong>{{ D.edge_label }}</strong></p>
      <p>{{ lv.edge }}</p>
    {%- endif -%}

    {%- if D.flows_label and lv.flows and lv.flows.size > 0 -%}
      <p><strong>{{ D.flows_label }}</strong></p>
      <ul>
        {%- for f in lv.flows -%}
          {%- if f.url -%}
            {%- if f.url | slice: 0, 1 == "/" -%}
              <li><a href="{{ f.url | relative_url }}">{{ f.label }}</a></li>
            {%- else -%}
              <li><a href="{{ f.url }}">{{ f.label }}</a></li>
            {%- endif -%}
          {%- else -%}
            <li>{{ f.label }}</li>
          {%- endif -%}
        {%- endfor -%}
      </ul>
    {%- endif -%}
  </section>
  {%- endfor -%}

{%- endif -%}
