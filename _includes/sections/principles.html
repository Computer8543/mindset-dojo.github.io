{%- comment -%}
Simple principles include â€” lean and readable.

Inputs (from dispatch):
- section.data.principles   => ARRAY of ids (optional)
- section.data.principle_type => STRING (optional)

Behavior:
- Load dataset from include.page_data or site.data.sections.principles
- Optionally filter by principle_type
- If an id list is provided, select items in that order; otherwise render the filtered set
- Pass { data: { label, items } } to sections/list.html
{%- endcomment -%}

<pre>
    include.section: {{ include.section | inspect }}
    include.page_data present?: {{ include.page_data | inspect }}
    src: {{ include.section.data.principles | inspect }}
    items: {{ include.page_data.items | map:"id" | inspect }}
    sel_type: {{ include.section.data.principle_type | inspect }}
</pre>


{%- assign principles = include.page_data | default: site.data.sections.principles -%}
{%- assign items = principles.items -%}

{%- assign sel_type = include.section.data.principle_type -%}
{%- if sel_type -%}
  {%- assign items = items | where: "type", sel_type -%}
{%- endif -%}

{% assign src = include.section.data.principles | default: page.principles %}
{%- if src -%}
  {%- assign final_items = "" | split: "|" -%}
  {%- for want in src -%}
    {%- for it in items -%}
      {%- if it.id == want -%}
        {%- assign final_items = final_items | push: it -%}
        {%- break -%}
      {%- endif -%}
    {%- endfor -%}
  {%- endfor -%}
{%- else -%}
  {%- assign final_items = items -%}
{%- endif -%}

{%- assign list_section = { "data": { "label": "Related Principles", "items": final_items } } -%}
{% include sections/list.html section=list_section %}
