{%- comment -%}
Render principles referenced by a page or section.

Inputs accepted:
- include.principles (array or CSV/JSON-like string)
- section.data.principles
- page.principles

Also supports selecting a full type via:
- include.principle_type or section.data.principle_type (maps into principle_type)

Outputs:
- Calls sections/list.html with section object: { label, items }
{%- endcomment -%}

{%- assign src = include.principles | default: section.data.principles | default: page.principles -%}
{%- assign section_types = include.principle_type | default: section.data.principle_type | default: page.principle_type -%}
{%- assign data = site.data.sections.principles -%}
{%- assign matched = "" | split: "|" -%}

{%- if section_types -%}
  {%- comment -%} match requested types against the grouped items {%- endcomment -%}
  {%- assign matched = "" | split: "|" -%}
  {%- for item in data.items -%}
    {%- for want_type in section_types -%}
      {%- if item.type == want_type -%}
        {%- assign matched = matched | push: item -%}
        {%- break -%}
      {%- endif -%}
    {%- endfor -%}
  {%- endfor -%}
  {%- assign list_section = matched -%}

{%- elsif src -%}
  {%- comment -%} match requested ids against the flat items array {%- endcomment -%}
  {%- for item in data.items -%}
    {%- for want in src -%}
      {%- assign want_norm = want | to_s | slugify -%}
      {%- if item.id == want or item.id == want_norm -%}
        {%- assign matched = matched | push: item -%}
        {%- break -%}
      {%- endif -%}
    {%- endfor -%}
  {%- endfor -%}

  {%- assign list_section = 
      {
        "label": "Principles",
        "items": matched
      }
  -%}

{%- else -%}
  {%- assign list_section = 
      {
        "label": "Principles",
        "items": "" | split: "|"
      }
  -%}
{%- endif -%}

{% include sections/list.html section=list_section %}