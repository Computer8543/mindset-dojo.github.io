{%- comment -%}
Static dispatcher for section includes (broad Jekyll compatibility).
Each case delegates to a small, focused template for that section type.
{%- endcomment -%}

{%- case section.type -%}

  {%- when 'author' -%}
    {%- assign slug = page.slug | downcase -%}
    {%- assign doc  = site.authors | where:"slug", slug | first -%}
    {%- assign one_author = "" | split:"|" -%}
    {%- assign one_author = one_author | push: slug -%}
    {% include sections/authors.html section=section authors=one_author %}

  {%- when 'authors' -%}
    {% include sections/authors.html section=section %}

  {%- when 'ctas' -%}
    {% include sections/ctas.html section=section %}

  {%- when 'designations' -%}
    {% include sections/designations.html section=section data=data %}
  
  {%- when 'insight-item' -%}
    {% include sections/insight-item.html section=section data=data %}

  {%- when 'insight-stream' -%}
    {%- comment -%}
    Include insight-stream once. If we're rendering an author page and the
    section doesn't already declare authors, pass a page.slug override.
    {%- endcomment -%}
    {%- assign has_section_authors = false -%}
    {%- if section and section.data and section.data.authors != nil and section.data.authors != "" -%}
      {%- assign has_section_authors = true -%}
    {%- endif -%}

    {%- if page.data_key == "author" and has_section_authors == false -%}
      {% include sections/insight-stream.html section=section data=data authors=page.slug %}
    {%- else -%}
      {% include sections/insight-stream.html section=section data=data %}
    {%- endif -%}

  {%- when 'levels' -%}
    {% include sections/levels.html section=section %}

  {%- when 'list' -%}
    {% include sections/list.html section=section %}

  {%- when 'markdown' -%}
    {% include sections/markdown.html section=section %}

  {%- when 'mission' -%}
    {% include sections/mission.html section=section data=data data_key=data_key %}

   {%- when 'parse-post-authors' -%}
    {% include sections/parse-post-authors.html section=section p_auth=p.authors %}

  {%- when 'quote' -%}
    {% include sections/quote.html section=section %}

  {%- when 'text' -%}
    {% include sections/text.html section=section %}

{%- endcase -%}
